15) cycriptë¡œ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ì— attachí•´ì„œ propertyë¥¼ ë³€ê²½í•˜ê³  í•¨ìˆ˜ë¥¼ ë™ì ìœ¼ë¡œ í˜¸ì¶œ ê°€ëŠ¥ (ë™ì  ë¶„ì„)
- ì‹¤í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ì— ì—°ê²°í•˜ì—¬ ì‚¬ìš©ì¤‘ì¸ ëª¨ë“  í´ë˜ìŠ¤ì˜ ì´ë¦„ (ì˜ˆ : ë·° ì»¨íŠ¸ë¡¤ëŸ¬, ì‚¬ìš©ì¤‘ì¸ ë‚´ë¶€ ë° íƒ€ì‚¬ ë¼ì´ë¸ŒëŸ¬ë¦¬, ì‹¬ì§€ì–´ ì‘ìš© í”„ë¡œê·¸ë¨ ëŒ€ë¦¬ì¸ì˜ ì´ë¦„)ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- íŠ¹ì • í´ë˜ìŠ¤ (ì˜ˆ : View Controller, App ëŒ€ë¦¬ì ë˜ëŠ” ê¸°íƒ€ í´ë˜ìŠ¤)ì˜ ê²½ìš° ì‚¬ìš©ì¤‘ì¸ ëª¨ë“  ë©”ì„œë“œì˜ ì´ë¦„ì„ ì°¾ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
- ë˜í•œ ì‘ìš© í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ëŠ” ë™ì•ˆ íŠ¹ì • ì‹œê°„ì— ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ì˜ ì´ë¦„ê³¼ í•´ë‹¹ ê°’ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ëŸ°íƒ€ì„ ì¤‘ì— ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ì˜ ê°’ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- Method Swizzlingì„ ìˆ˜í–‰ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¦‰, íŠ¹ì • ë©”ì†Œë“œì˜ ì½”ë“œë¥¼ ë‹¤ë¥¸ êµ¬í˜„ìœ¼ë¡œ ë°”ê¿‰ë‹ˆë‹¤.
- ì‘ìš© í”„ë¡œê·¸ë¨ì˜ ì‹¤ì œ ì½”ë“œì— ìˆì§€ ì•Šì•„ë„ ëŸ°íƒ€ì„ ë™ì•ˆ ì‘ìš© í”„ë¡œê·¸ë¨ì˜ ëª¨ë“  ë©”ì„œë“œë¥¼ í˜¸ì¶œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

heonjin-iPhone:/var/mobile/Applications/67D95CAC-test-4BA5-8025-000000000000/test.app root# ps -ef | grep test
  501  1556     1   0   0:00.00 ??         0:02.33 /var/mobile/Applications/67D95CAC-test-4BA5-8025-000000000000/test.app/test
heonjin-iPhone:/var/mobile/Applications/67D95CAC-test-4BA5-8025-000000000000/test.app root# cycript -p 1556
cy# UIApp
#"<UIApplication: 0x17d80150>"
cy# UIApp.delegate
\#"<TestAppDelegate: 0x17d9bb90>"

- ì•±ì˜ í˜„ì¬ ë·° ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´, keyWindow ì†ì„±ì„ ì°¾ì•„ì•¼ í•¨
cy# UIApp.windows
@[#"<UIWindow: 0x17dd45a0; frame = (0 0; 320 480); opaque = NO; autoresize = RM+BM; gestureRecognizers = <NSArray: 0x17dd4be0>; layer = <UIWindowLayer: 0x17dd46d0>>"]
cy# UIApp.keyWindow
#"<UIWindow: 0x17dd45a0; frame = (0 0; 320 480); opaque = NO; autoresize = RM+BM; gestureRecognizers = <NSArray: 0x17dd4be0>; layer = <UIWindowLayer: 0x17dd46d0>>"

- view delegate í™•ì¸
cy# UIApp.delegate
#"<TestAppDelegate: 0x17d9bb90>"
-> ë”œë¦¬ê²Œì´íŠ¸ í´ë˜ìŠ¤ ì´ë¦„ì´ TestAppDelegate ì¸ ê²ƒì„ í™•ì¸ ê°€ëŠ¥í•¨

- root view í™•ì¸
cy# UIApp.keyWindow.rootViewController 
#"<UIViewController: 0x17d99ce0>"
-> í´ë˜ìŠ¤ëª…ìœ¼ë¡œ ìœ ì¶”í•´ë´¤ì„ë•Œ UIViewControllerëŠ” UIë¥¼ ë³´ì—¬ì£¼ëŠ” í™”ë©´ìœ¼ë¡œ ì¶”ì¸¡ì´ë¨

- View ê³„ì¸µ í™•ì¸í•˜ê¸°
cy# UIApp.keyWindow.recursiveDescription()
throw new TypeError(`'<UIWindow: 0x17dd45a0; frame = (0 0; 320 480); opaque = NO; autoresize = RM+BM; gestureRecognizers = <NSArray: 0x17dd4be0>; layer = <UIWindowLayer: 0x17dd46d0>>
   | <UIView: 0x17ef0c80; frame = (0 0; 320 480); autoresize = W+H; layer = <CALayer: 0x17dbf6b0>>
   | <UILayoutContainerView: 0x17dd2200; frame = (0 0; 320 480); autoresize = W+H; layer = <CALayer: 0x17ed11c0>>
   |    | <UITransitionView: 0x17ec9670; frame = (0 0; 320 480); clipsToBounds = YES; autoresize = W+H; layer = <CALayer: 0x17ed5830>>
   |    |    | <UIViewControllerWrapperView: 0x17eca3b0; frame = (0 0; 320 480); autoresize = W+H; layer = <CALayer: 0x17dd2e40>>
   |    |    |    | <UIView: 0x17dd2770; frame = (0 0; 320 431); autoresize = W+H; layer = <CALayer: 0x17ef71e0>>
   |    |    |    |    | <UIImageView: 0x17d9fb10; frame = (0 0; 320 431); autoresize = W+H; userInteractionEnabled = NO; layer = <CALayer: 0x17eb8db0>>
   |    |    |    |    | <UILabel: 0x17dca060; frame = (112 294; 42 21); text = '1.3'; clipsToBounds = YES; opaque = NO; autoresize = TM; userInteractionEnabled = NO; layer = <CALayer: 0x17eeefd0>>
   |    |    |    |    | <UIButton: 0x17ec86c0; frame = (112 318; 180 25); opaque = NO; autoresize = TM; layer = <CALayer: 0x17d8e290>>
   |    |    |    |    |    | <UIButtonLabel: 0x17ea71e0; frame = (0 4; 150 17); text = 'test@testweb.com'; clipsToBounds = YES; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0x17ed18f0>>
   |    |    |    |    | <UILabel: 0x17ed2620; frame = (112 344; 180 25); text = 'www.testweb.co.kr'; clipsToBounds = YES; opaque = NO; autoresize = TM; userInteractionEnabled = NO; layer = <CALayer: 0x17ec2990>>
   |    | <UITabBar: 0x17dcc5e0; frame = (0 431; 320 49); autoresize = W+TM; layer = <CALayer: 0x17dcc770>>
   |    |    | <_UITabBarBackgroundView: 0x17ed76d0; frame = (0 0; 320 49); autoresize = W; userInteractionEnabled = NO; layer = <CALayer: 0x17ed6da0>>
   |    |    |    | <_UIBackdropView: 0x17ed79a0; frame = (0 0; 320 49); opaque = NO; autoresize = W+H; 
cy# [[UIApp keyWindow] recursiveDescription].toString()
`<UIWindow: 0x17dd45a0; frame = (0 0; 320 480); opaque = NO; autoresize = RM+BM; gestureRecognizers = <NSArray: 0x17dd4be0>; layer = <UIWindowLayer: 0x17dd46d0>>
   | <UIView: 0x17ef0c80; frame = (0 0; 320 480); autoresize = W+H; layer = <CALayer: 0x17dbf6b0>>
   | <UILayoutContainerView: 0x17dd2200; frame = (0 0; 320 480); autoresize = W+H; layer = <CALayer: 0x17ed11c0>>
   |    | <UITransitionView: 0x17ec9670; frame = (0 0; 320 480); clipsToBounds = YES; autoresize = W+H; layer = <CALayer: 0x17ed5830>>
   |    |    | <UIViewControllerWrapperView: 0x17eca3b0; frame = (0 0; 320 480); autoresize = W+H; layer = <CALayer: 0x17dd2e40>>
   |    |    |    | <UIView: 0x17dd2770; frame = (0 0; 320 431); autoresize = W+H; layer = <CALayer: 0x17ef71e0>>
   |    |    |    |    | <UIImageView: 0x17d9fb10; frame = (0 0; 320 431); autoresize = W+H; userInteractionEnabled = NO; layer = <CALayer: 0x17eb8db0>>
   |    |    |    |    | <UILabel: 0x17dca060; frame = (112 294; 42 21); text = '1.3'; clipsToBounds = YES; opaque = NO; autoresize = TM; userInteractionEnabled = NO; layer = <CALayer: 0x17eeefd0>>
   |    |    |    |    | <UIButton: 0x17ec86c0; frame = (112 318; 180 25); opaque = NO; autoresize = TM; layer = <CALayer: 0x17d8e290>>
   |    |    |    |    |    | <UIButtonLabel: 0x17ea71e0; frame = (0 4; 150 17); text = 'test@testweb.com'; clipsToBounds = YES; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0x17ed18f0>>
   |    |    |    |    | <UILabel: 0x17ed2620; frame = (112 344; 180 25); text = 'www.testweb.co.kr'; clipsToBounds = YES; opaque = NO; autoresize = TM; userInteractionEnabled = NO; layer = <CALayer: 0x17ec2990>>
   |    | <UITabBar: 0x17dcc5e0; frame = (0 431; 320 49); autoresize = W+TM; layer = <CALayer: 0x17dcc770>>
   |    |    | <_UITabBarBackgroundView: 0x17ed76d0; frame = (0 0; 320 49); autoresize = W; userInteractionEnabled = NO; layer = <CALayer: 0x17ed6da0>>
   |    |    |    | <_UIBackdropView: 0x17ed79a0; frame = (0 0; 320 49); opaque = NO; autoresize = W+H; userInteractionEnable

- ì˜ˆë¥¼ ë“¤ì–´ ì‘ì—…í•´ë³´ê¸°
cy# [UIApplication sharedApplication]
#"<UIApplication: 0x145a1d60>"
cy# var a = [UIApplication sharedApplication]
#"<UIApplication: 0x145a1d60>"
cy# a
#"<UIApplication: 0x145a1d60>"
cy# UIApp
#"<UIApplication: 0x145a1d60>"
cy# a.delegate
#"<TestAppDelegate: 0x145bdfa0>"

cy# [[UIApplication sharedApplication] setStatusBarHidden:YES animated:YES]
-> í”„ë¡œê·¸ë¨ìƒë‹¨ì˜ ìƒíƒœí‘œì‹œë°”ê°€ ì‚¬ë¼ì§€ê²Œë¨
cy# [[UIApplication sharedApplication] setStatusBarHidden:NO animated:NO]

cy# [[UIApplication sharedApplication] setApplicationIconBadgeNumber:100]
-> í”„ë¡œê·¸ë¨ ë±ƒì§€ ê°¯ìˆ˜ë¥¼ í‘œì‹œí•˜ì§€ ì•ŠëŠ” ì•±ì´ë‚˜ 100ê°œë¡œ í‘œì‹œë˜ê²Œ ì„¤ì • ê°€ëŠ¥í•¨
cy# [[UIApplication sharedApplication] setApplicationIconBadgeNumber:0]

	- ì—ëŸ¬ì˜ ì´ìœ ë¥¼ ëª¨ë¥´ê² ë‹¤ ì»¤ë„ë²„ì „ ì—…ë°ì´íŠ¸ë¥¼ í•´ì£¼ë¼ëŠ” ë§ì´ ìˆìŒ
cy# UIApp.keyWindow.rootViewController
#"<UIViewController: 0x16da4ec0>"
cy# function printMethods(className){
    var count = new new Type("I");
    var methods = class_copyMethodList(objc_getClass(className), count);
    var methodsArray = [];
    for (var i = 0; i< *count; i++){
    var method = methods[i];
    methodsArray.push({selector:method_getName(method), implementation:method_getImplementation(method)});
    }
    free(methods);
    free(count);
    return methodsArray;
    }
cy# printMethods(UIViewController)
MS:Error: _krncall(mach_vm_read_overwrite(task, data, sizeof(*baton), reinterpret_cast<mach_vm_address_t>(baton), &error)) =268435459
*** _assert(status == 0):../Inject.cpp(143):InjectLibrary

--------------------------------------------------------------------------------------------------

16) keychain_dumper ë¥¼ ì´ìš©í•˜ì—¬ iOSì— ë³´ê´€í•˜ëŠ” keychain ë°ì´í„°ë¥¼ ì¶”ì¶œí•¨
- Keychain_Dumperë¥¼ ì„¤ì¹˜ (https://github.com/ptoomey3/Keychain-Dumper )

- ëª¨ë“  Keychain ì ‘ê·¼ ê·¸ë£¹ ê¶Œí•œ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆëŠ” entitlements íŒŒì¼ì„ ê°€ì§€ê³  ìˆê±°ë‚˜ ëª¨ë“  Keychain ë°ì´í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ”  Keychain ì ‘ê·¼ ê·¸ë£¹ ê¶Œí•œì„ ì‚¬ìš©í•˜ëŠ” ê²ƒ
/private/var/Keychains/keychain-2.db ì˜ ê¶Œí•œì„ ë³€ê²½ - chmod +r ./keychain-2.db
( heonjin-iPhone:/var/mobile/downloads/Keychain-Dumper-master root# ls -al /private/var/Keychains/keychain-2.db
-rw------- 1 _securityd wheel 339968 Aug  1  2017 /private/var/Keychains/keychain-2.db)
-> -rw-r--r-- 1 _securityd wheel 339968 Aug  1  2017 /private/var/Keychains/keychain-2.db

- ./keychain_dumper -a > keychain.txt
heonjin-iPhone:/var/mobile/downloads/Keychain-Dumper-master root# head -20 keychain.txt 
Generic Password
----------------
Service: iCloud Keychain Account Meta-data
Account: 
Entitlement Group: com.apple.security.sos
Label: (null)
Accessible Attribute: kSecAttrAccessibleAlwaysThisDeviceOnly, protection level 3
Description: (null)
Comment: (null)
Synchronizable: 0
Generic Field: (null)
Generic Password 
----------------
Service: AirPort
Account: Imagine_heonjin
Entitlement Group: apple
Label: (null)
Accessible Attribute: kSecAttrAccessibleAfterFirstUnlock, protection level 1
Description: (null)
Comment: (null)
Synchronizable: 0
Generic Field: (null)
Keychain Data: wifi#123

17) sqlite3ì„ ì‚¬ìš©í•´ì„œ ë¡œì»¬ë“œë¼ì´ë¸Œì— ì €ì¥ë˜ì–´ ìˆëŠ” ì •ë³´ë“¤ì„ í™•ì¸ í•  ìˆ˜ ìˆìŒ
heonjin-iPhone:/var/mobile/Containers root# find / -name "*sqlite"
/private/var/mobile/Applications/5A692080-5B58-test-B4D8-00000/Documents/Users/375832242/Uploads.sqlite
/private/var/mobile/Applications/5A692080-5B58-test-B4D8-00000/Library/Caches/PSPDFKit/Index/index.sqlite
/private/var/mobile/Applications/67D95CAC-4D7D-test-8025-00000/Library/Caches/com.test/SnoopiCache/SnoopiDataStore/com.test_DebugLogMonitor.sqlite
/private/var/mobile/Applications/67D95CAC-4D7D-test-8025-00000/Library/Caches/com.test/SnoopiCache/SnoopiDataStore/com.test_FilesystemMonitor.sqlite
/private/var/mobile/Applications/EEE82BFD-6888-test-B6D3-00000/KakaoTalk.app/Message.sqlite
/private/var/mobile/Applications/EEE82BFD-6888-test-B6D3-00000/KakaoTalk.app/client_log.sqlite

sqlite> .tables 
filesystem

sqlite> .schema
CREATE TABLE filesystem ('id' INTEGER PRIMARY KEY  AUTOINCREMENT  NOT NULL  UNIQUE,'timestamp' REAL NOT NULL,'path' VARCHAR(255) NOT NULL,'protection_class' INTEGER NOT NULL,'access_mode' INTEGER,'other_flags' TEXT,'sandbox' INTEGER NOT NULL,'type' INTEGER NOT NULL,'action' INTEGER NOT NULL);
CREATE TABLE sqlite_sequence(name,seq);
CREATE INDEX filesystem_timeindex on filesystem(timestamp);

sqlite> select * from filesystem;
1|1575614656.62173|/System/Library/Caches/com.apple.dyld/dyld_shared_cache_armv7|1|1||0|0|1
2|1575614656.91251|/var/mobile/Applications/67D95CAC-4D7D-test-8025-0000/test.app/test@2x~iphone.png|1|1||1|0|1
3|1575614656.93559|/var/mobile/Applications/67D95CAC-4D7D-test-8025-0000/test.app/test@2x~iphone.png|1|1||1|0|1
4|1575614656.96131|/var/mobile/Applications/67D95CAC-4D7D-test-8025-0000/test.app/test@2x.png|1|1||1|0|1
5|1575614656.99234|/var/mobile/Applications/67D95CAC-4D7D-test-8025-0000/test.app/test@2x~iphone.png|1|1||1|0|1
6|1575614657.01585|/var/mobile/Applications/67D95CAC-4D7D-test-8025-0000/test.app/test@2x~iphone.png|1|1||1|0|1

18) ê°œë°œìê°€ ê°œì¸ì •ë³´ì™€ ê°™ì€ ì£¼ìš” ë°ì´í„°ë¥¼ plist íŒŒì¼ì— ì €ì¥í•´ ê°œì¸ì •ë³´ë“¤ì´ ìœ ì¶œë  ìˆ˜ ìˆìŒ
heonjin-iPhone:~ root# cat /private/var/mobile/Applications/67D95CAC-4D7D-test-8025-0000/Library/Caches/com.test/SnoopiCache/com.test_NetworkInterfaces.plist
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
        <key>Interfaces</key>
        <array>
                <dict>
                        <key>Active</key>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

19) App Screenshot ë³µêµ¬í•´ë³´ê¸°
heonjin-iPhone:~ root# find / -name "*downscaled*"
/private/var/mobile/Applications/0B6997B2-8425-472B-906A-894D2B28674B/Library/Caches/Snapshots/com.path.Path/Main-downscaled
/private/var/mobile/Applications/16A3DB1C-0C05-4788-B182-E7B5B7CBAD2C/Library/Caches/Snapshots/com.mdlab.VevoMusic/Main-downscaled
/private/var/mobile/Applications/25DA1F38-DD04-4EE8-8A8A-87FD89F12B66/Library/Caches/Snapshots/fm.listr.listrfm/Main-downscaled
/private/var/mobile/Applications/3B57CAB4-02B0-4C1C-BC95-F993A96C0081/Library/Caches/Snapshots/com.testsoftenter.testsns/Main-downscaled
/private/var/mobile/Applications/419379EB-4164-4DA8-9A8F-F6D863BC2815/Library/Caches/Snapshots/com.apple.mobilemail/Main-downscaled
/private/var/mobile/Applications/4B148588-0634-4428-92A9-DA56FF2E2221/Library/Caches/Snapshots/com.apple.mobilesafari/Main-downscaled
/private/var/mobile/Applications/57CD5905-8CAC-42AA-A23B-FF38246396D1/Library/Caches/Snapshots/com.nhncorp.ndrive/Main-downscaled
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
-> í•´ë‹¹ ê²½ë¡œì— ë“¤ì–´ê°€ë©´ png íŒŒì¼ë“¤ ì¡´ì¬

20) Keystroke Logging - '/var/mobile/Library/Keyboard/' ì— ì €ì¥ë˜ì–´ ìˆëŠ” dat íŒŒì¼ë“¤ì„ í™•ì¸í•˜ë©´ í‚¤ë¡œê¹…ëœ ë‚´ìš©ë“¤ì„ ë³¼ ìˆ˜ ìˆìŒ (í‚¤ë¡œê±°ì•± ì„¤ì¹˜ë¡œë„ ê°€ëŠ¥)
heonjin-iPhone:/var/mobile/Library/Keyboard root# cat dynamic-text.dat 
DynamicDictionary-5stbigbossbillboardbinbiteyourapplebbuildbychriszincomecomconcerncontract
worksiteworksitwrpuigfh wwwwWyoutubeyzumã…‡í˜¸ã…—ã…—ã…ã…ã„¹ã„¹heonjin-iPhone:/var/mobile/Library/Keyboard root# cat Lexierra_ja_JP-dynamic-text.dat 
Çƒq

[UIPasteboard generalPasteboard].items[0]

21) sqlite3 ëª…ë ¹ìœ¼ë¡œ find / -name "*.sqlite" ë¥¼ í†µí•´ì„œ ì–»ì€ íŒŒì¼ë“¤ì—ì„œ ê°œì¸ì •ë³´ë¥¼ ì¶”ì¶œ í•  ìˆ˜ ìˆìŒ
- Accounts3.sqlite íŒŒì¼ì„ í†µí•´ì„œ ì–´í”Œì—ì„œ ì‚¬ìš©ë˜ì—ˆë˜ ê°œì¸ ì •ë³´ë“¤ ìœ ì¶œ
heonjin-iPhone:/var/mobile/Library/Keyboard root# sqlite3 /private/var/mobile/Library/Accounts/Accounts3.sqlite
sqlite> select * from ZACCOUNT;
1|2|1|1|0|0|0|2||433160780.192082||Holiday 
26|2|4|1|1|1|1|3||597224109.234002|||||1F9306BF-7894-4000-8657-test||heonjin@test.com|
27|2|1|1|1|1|1|8||597224158.782893|||||917B770C-E459-43D1-A0D7-test||heonjin@test.com|

- UserInfo.sqlite íŒŒì¼ì„ í†µí•´ì„œ ê³„ì •ê³¼ íŒ¨ìŠ¤ì›Œë“œë¥¼ ìœ ì¶œ í•  ìˆ˜ ìˆìŒ
heonjin-iPhone:/var/mobile/Library/Keyboard root# sqlite3 /private/var/mobile/Applications/BF3886AB-EE78-4EA6-9F63-6EF172CCA6C6/Documents/UserInfo.sqlite
SQLite version 3.29.0 2019-07-10 17:32:03
Enter ".help" for usage hints.
sqlite> .tables
ZLASTLOGIN    ZUSER         Z_METADATA    Z_PRIMARYKEY
sqlite> select * from ZLASTLOGIN; 
3|1|1|heonjin
sqlite> select * from ZUSER;
2|2|1|1|0|heonjin|heonjin|test!|

22) fiddlerë¥¼ í†µí•´ì„œ íŒ¨í‚· ë¤í”„ë¥¼ ë– ì„œ íŠ¹ì´í•œ í†µì‹  í™•ì¸ (ë¯¼ê°ë°ì´í„°ê°€ í‰ë¬¸ìœ¼ë¡œ ë‚ ì•„ê°€ëŠ”ì§€ í™•ì¸ í•„ìš” - wireshark)
- PCì— fiddler ì„¤ì¹˜ ë° ì„¤ì •
Tools > Options > Connections > Allow remote computers to connect ì²´í¬
- íœ´ëŒ€í°ì—ì„œ í”¼ë“¤ëŸ¬ í”„ë¡ì‹œ ì„œë²„ê°€ ëŒì•„ê°€ê³  ìˆëŠ” 192.168.61.57:8888ë¡œ ì ‘ì†í•´ì„œ Fiddler Echo Service í™”ë©´ì´ ë‚˜ì˜¤ë©´ ì •ìƒì ìœ¼ë¡œ ì…‹íŒ…ëœ ê²ƒì„
- ì„¤ì • > ì¼ë°˜ > wifi > ì—°ê²°ëœ wifi ì„ íƒ > HTTP í”„ë¡ì‹œ ìˆ˜ë™ > í”„ë¡ì‹œ ì„œë²„ ì„¤ì • 
- https íŒ¨í‚·ì„ ë³´ê¸°ìœ„í•´ì„œëŠ” fiddlerì—ì„œ ì œê³µí•˜ëŠ” ì¸ì¦ì„œë¥¼ PCì™€ ëª¨ë°”ì¼ì—ì„œ ëª¨ë‘ ì„¤ì¹˜í•˜ì—¬ì„œ ì‘ì—…ì´ ë˜ì•¼í•œë‹¤.

23) ì›¹ OWASP Top 10 ê³µê²©
- ì¸ì ì…˜, XXS, CSRF, íŒŒì¼ë‹¤ìš´ë¡œë“œ, íŒŒì¼ì—…ë¡œë“œ ì‹œë„ ë“±
-> ì›¹ì—ì„œ ì‹¤í–‰í–ˆì„ë•Œì™€ ì•±ì—ì„œ ì‹¤í–‰í–ˆì„ë•Œ í†µì‹ ì˜ ê²½ë¡œê°€ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ

24) OWASP Top 10 - Code Tampering ì·¨ì•½ì 
ë³€ì¡°ëœ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ íƒˆì˜¥ ë˜ëŠ” ë£¨íŒ…ëœ ë””ë°”ì´ìŠ¤ì—ì„œ ì •ìƒ êµ¬ë™ ë˜ëŠ” ì·¨ì•½ì  (ì•±ì˜ ë¦¬íŒ¨í‚¤ì§•ì„ í†µí•´ ê°œì¸ì •ë³´ ìœ ì¶œì´ë‚˜ ìŠ¤ë¯¸ì‹± ê³µê²©ì— í™œìš© ë  ìˆ˜ ìˆìŒ)
-> ê°„ë‹¨í•œ í™•ì¸ìœ¼ë¡œëŠ” HxDì—ì„œ íŠ¹ì • ë¬¸ìì—´ Hexê°’ì„ ë³€í™˜í–ˆì„ë•Œ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ì´ ë˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŒ

25) Pasteboard - ì•±ì—ì„œ ì €ì¥í–ˆë˜ ë³µì‚¬í•œ ë°ì´í„°ë¥¼ í†µí•´ ì‘ì„±ì¤‘ì´ë˜ ì •ë³´ë¥¼ íšë“í•  ìˆ˜ ìˆìŒ
heonjin-iPhone:~ root# cycript -p 2761

cy# [UIPasteboard generalPasteboard]
#"<UIPasteboard: 0x19d84390>"

cy# [UIPasteboard generalPasteboard].items[0]
@{"public.utf8-plain-text":"Ggfff\nSecurity heon"}

- ë¦¬ëˆ…ìŠ¤ ìµœê·¼ ìƒì„±ëœ íŒŒì¼ í™•ì¸
find / -type f -mtime -ì¼ìˆ˜ -print

26) sqlite3ê³¼ find / -name "*.db" ë¥¼ í†µí•´ì„œ ì•±ë‚´ì— ì €ì¥ëœ dbì •ë³´ë¥¼ í™•ì¸ í•  ìˆ˜ ìˆìŒ
heonjin-iPhone:~ root# sqlite3 /private/var/Keychains/keychain-2.db
SQLite version 3.29.0 2019-07-10 17:32:03
Enter ".help" for usage hints.
sqlite> .tables
cert      genp      inet      keys      tversion
sqlite> select * from keys;
2U	|0|73|256|256|0.0|0.0|0|0|1|0|0|1|1|1|0|0|0|0|1||ichat|dku|0|0|r_
                                                                     s)*0
2U	|0|42|1280|1280|0.0|0.0|0|0|1|0|0|1|1|1|0|0|0|0|1||ichat|dku|0|0|rPjC
|433160896.252873|433160896.252873|<XVss1v|1|1|1|NfWtB"|^kK
82|1|1|ËƒL                                                                 7|433404888.661284|433404888.661284|<XVssF

27) iNalyzerë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì  ë¶„ì„

28) Introspy
https://github.com/iSECPartners/Introspy-iOS/releases/download/ios-tracer-v0.4/com.isecpartners.introspy-v0.4-iOS_7.deb




â€» iOS ì•ˆí‹° ë””ë²„ê¹… ë°©ë²•
1) ios ë””ë²„ê¹… ë°©ì§€ ì½”ë“œ ì¶”ê°€
#ifndef DEBUG
    ptrace (PT_DENY_ATTACH, 0, 0, 0);
#endif

2) ë©”ì†Œë“œë¥¼ ê³µê²©ìê°€ ì ‘ê·¼í•  ì´ë¦„ìœ¼ë¡œ ìœ ë„í•˜ì—¬ ë¶ˆë²•ì ìœ¼ë¡œ ì ‘ê·¼í•˜ëŠ” ê³µê²©ìì— ëŒ€í•´ ì œì œë¥¼ ê°€í•  ìˆ˜ ìˆìŒ
ex) Cycriptë¥¼ ì‚¬ìš©í•˜ì—¬ userLogin ë©”ì†Œë“œì— ì ‘ê·¼ì„ í•œë‹¤ë©´ ì•±ì˜ ì¤‘ìš” ì •ë³´ë¥¼ ì§€ìš°ê¸° ë“± (exit(-1);)

3) Cydiaì™€ ê°™ì€ í”„ë¡œê·¸ë¨ì´ ê¹”ë ¤ìˆëŠ”ì§€ í™•ì¸ í•˜ì—¬ íƒˆì˜¥ ì—¬ë¶€ í™•ì¸
NSString *filePath = @"/Applications/Cydia.app";
if ([[NSFileManager defaultManager] fileExistsAtPath:filePath])
{
    //Device is jailbroken
}

-----------------------------------------------------------------------------------------------------------------------

+(BOOL)isJailbroken{
  
#if !(hack_iphone)

   if ([[NSFileManager defaultManager] fileExistsAtPath:@"/Applications/Cydia.app"]){
      return YES;
    }else if([[NSFileManager defaultManager] fileExistsAtPath:@"/Library/MobileSubstrate/MobileSubstrate.dylib"]){
      return YES;
    }else if([[NSFileManager defaultManager] fileExistsAtPath:@"/bin/bash"]){
      return YES;
    }else if([[NSFileManager defaultManager] fileExistsAtPath:@"/usr/sbin/sshd"]){
      return YES;
    }else if([[NSFileManager defaultManager] fileExistsAtPath:@"/etc/apt"]){
      return YES;
    }

  NSError *error;
    NSString *stringToBeWritten = @"This is a test.";
    [stringToBeWritten writeToFile:@"/private/jailbreak.txt" atomically:YES
          encoding:NSUTF8StringEncoding error:&error];
    if(error==nil){
    //Device is jailbroken
    return YES;
  } else {
    [[NSFileManager defaultManager] removeItemAtPath:@"/private/jailbreak.txt" error:nil];
  }

  if([[UIApplication sharedApplication] canOpenURL:[NSURL URLWithString:@"cydia://package/com.example.package"]]){
    //Device is jailbroken
    return YES;
  }
#endif

  //All checks have failed. Most probably, the device is not jailbroken
  return NO;
}

-> ìš°íšŒí•˜ëŠ” ë°©ë²•
1) Class-dump-zë¥¼ ì‚¬ìš©í•˜ì—¬ í´ë˜ìŠ¤ ì •ë³´ë¥¼ í™•ë³´
2) Cycriptë¥¼ í†µí•´ JailDetector->isa.messages
3) ìš°íšŒë¥¼ ìœ„í•´ ë©”ì†Œë“œì˜ í•¨ìˆ˜ ë‚´ìš©ì„ ë³€ê²½ì‹œì¼œì¤Œ
JailDetector->isa.messages['isJailbroken'] = function() { return false; }
[JailDetector isJailbroken]
0
=> returnì´ trueì—ì„œ falseë¡œ ë°”ë€Œê²Œë˜ì–´ ì¢…ë£Œí•˜ì§€ ì•Šê²Œë¨